
// JS Version
/* https://editor.p5js.org/AqilCont/sketches/e9ryvv6zx */

// Holds the piece data, every block for rotation
piece pdata[7] = {
  {
		{{ .x = 0, .y = 1 }, { .x = 1, .y = 1 }, { .x = 2, .y = 1 }, { .x = 3, .y = 1 }},
    {{ .x = 2, .y = 0 }, { .x = 2, .y = 1 }, { .x = 2, .y = 2 }, { .x = 2, .y = 3 }},
    {{ .x = 0, .y = 2 }, { .x = 1, .y = 2 }, { .x = 2, .y = 2 }, { .x = 3, .y = 2 }},
    {{ .x = 1, .y = 0 }, { .x = 1, .y = 1 }, { .x = 1, .y = 2 }, { .x = 1, .y = 3 }}
  }, // I
  {
		{{ .x = 1, .y = 0 }, { .x = 0, .y = 1 }, { .x = 1, .y = 1 }, { .x = 2, .y = 1 }},
    {{ .x = 1, .y = 0 }, { .x = 1, .y = 1 }, { .x = 2, .y = 1 }, { .x = 1, .y = 2 }},
    {{ .x = 0, .y = 1 }, { .x = 1, .y = 1 }, { .x = 2, .y = 1 }, { .x = 1, .y = 2 }},
    {{ .x = 1, .y = 0 }, { .x = 0, .y = 1 }, { .x = 1, .y = 1 }, { .x = 1, .y = 2 }}
  }, // T
  {
		{{ .x = 2, .y = 0 }, { .x = 0, .y = 1 }, { .x = 1, .y = 1 }, { .x = 2, .y = 1 }},
    {{ .x = 1, .y = 0 }, { .x = 1, .y = 1 }, { .x = 1, .y = 2 }, { .x = 2, .y = 2 }},
    {{ .x = 0, .y = 1 }, { .x = 1, .y = 1 }, { .x = 2, .y = 1 }, { .x = 0, .y = 2 }},
    {{ .x = 0, .y = 0 }, { .x = 1, .y = 0 }, { .x = 1, .y = 1 }, { .x = 1, .y = 2 }}
  }, // L
  {
		{{ .x = 0, .y = 0 }, { .x = 0, .y = 1 }, { .x = 1, .y = 1 }, { .x = 2, .y = 1 }},
    {{ .x = 1, .y = 0 }, { .x = 2, .y = 0 }, { .x = 1, .y = 1 }, { .x = 1, .y = 2 }},
    {{ .x = 0, .y = 1 }, { .x = 1, .y = 1 }, { .x = 2, .y = 1 }, { .x = 2, .y = 2 }},
    {{ .x = 1, .y = 0 }, { .x = 1, .y = 1 }, { .x = 0, .y = 2 }, { .x = 1, .y = 2 }}
  }, // J
  {
		{{ .x = 1, .y = 0 }, { .x = 2, .y = 0 }, { .x = 0, .y = 1 }, { .x = 1, .y = 1 }},
    {{ .x = 1, .y = 0 }, { .x = 1, .y = 1 }, { .x = 2, .y = 1 }, { .x = 2, .y = 2 }},
    {{ .x = 1, .y = 1 }, { .x = 2, .y = 1 }, { .x = 0, .y = 2 }, { .x = 1, .y = 2 }},
    {{ .x = 0, .y = 0 }, { .x = 0, .y = 1 }, { .x = 1, .y = 1 }, { .x = 1, .y = 2 }}
  }, // S
  {
		{{ .x = 0, .y = 0 }, { .x = 1, .y = 0 }, { .x = 1, .y = 1 }, { .x = 2, .y = 1 }},
    {{ .x = 2, .y = 0 }, { .x = 1, .y = 1 }, { .x = 2, .y = 1 }, { .x = 1, .y = 2 }},
    {{ .x = 0, .y = 1 }, { .x = 1, .y = 1 }, { .x = 1, .y = 2 }, { .x = 2, .y = 2 }},
    {{ .x = 1, .y = 0 }, { .x = 0, .y = 1 }, { .x = 1, .y = 1 }, { .x = 0, .y = 2 }}
  }, // Z
  {
		{{ .x = 0, .y = 0 }, { .x = 1, .y = 0 }, { .x = 0, .y = 1 }, { .x = 1, .y = 1 }},
    {{ .x = 0, .y = 0 }, { .x = 1, .y = 0 }, { .x = 0, .y = 1 }, { .x = 1, .y = 1 }},
    {{ .x = 0, .y = 0 }, { .x = 1, .y = 0 }, { .x = 0, .y = 1 }, { .x = 1, .y = 1 }},
    {{ .x = 0, .y = 0 }, { .x = 1, .y = 0 }, { .x = 0, .y = 1 }, { .x = 1, .y = 1 }}
  } // O
};


// Colors for every block
vec3 colors[7] = {
  { 0.1921568627450980f, 0.6980392156862745f, 0.5098039215686274f }, // I
  { 0.6431372549019608f, 0.2392156862745098f, 0.6039215686274509f }, // T
  { 0.6980392156862745f, 0.3843137254901961f, 0.19215686274509805f }, // L
  { 0.3058823529411765f, 0.2392156862745098f, 0.6431372549019608f }, // J
  { 0.5098039215686274f, 0.6980392156862745f, 0.19215686274509805f }, // S
  { 0.6980392156862745f, 0.2f, 0.22745098039215686f }, // Z
  { 0.6980392156862745f, 0.6f, 0.19215686274509805f } // O
};


// Maps pieces to characters
char pmap[18];

// 'I' is 73 [0] = 0
// 'J' is 74 [1] = 3
// 'L' is 76 [3] = 2
// 'O' is 79 [6] = 6
// 'S' is 83 [9] = 4
// 'T' is 84 [10] = 1
// 'Z' is 90 [17] = 5

static inline piece* getp(char x) { return pdata + pmap[x - 'I']; }
static inline float* getcol(char x) { return colors[pmap[x - 'I']]; }

// vect srsjlstzcc[4][4] = {
//     1, 0, 1, -1, 0, 2, 1, 2,     // 0>>3
//     1, 0, 1, 1, 0, -2, 1, -2,    // 1>>0
//     -1, 0, -1, -1, 0, 2, -1, 2,  // 2>>1
//     -1, 0, -1, 1, 0, -2, -1, -2, // 3>>2
// };
// vect srsjlstzc[4][4] = {
//   -1, 0, -1, -1, 0, 2, -1, 2, // 0>>1
//   1, 0, 1, 1, 0, -2, 1, -2,   // 1>>2
//   1, 0, 1, -1, 0, 2, 1, 2,    // 2>>3
//   -1, 0, -1, 1, 0, -2, -1, -2 // 3>>0
// };

// // I?????????????
// int srsIBlockKickTable[4 * 4 * 2 * 2] = {
//     // ???
//     2, 0, -1, 0, -1, -2, 2, 1, // 0>>3
//     2, 0, -1, 0, 2, -1, -1, 2, // 1>>0
//     -2, 0, 1, 0, -2, -1, 1, 1, // 2>>1
//     1, 0, -2, 0, 1, -2, -2, 1, // 3>>2

//     // ???
//     -2, 0, 1, 0, -2, 1, 1, -2, // 0>>1
//     -1, 0, 2, 0, 2, 1, -1, -2, // 1>>2
//     2, 0, -1, 0, -1, 1, 2, -1, // 2>>3
//     -2, 0, 1, 0, 1, 2, -2, -1  // 3>>0
// };

// // 180???????????I???
// int srsOtherBlock180KickTable[11 * 2 * 4] = {
//     1, 0, 2, 0, 1, 1, 2, 1, -1, 0, -2, 0, -1, 1, -2, 1, 0, -1, 3, 0, -3, 0,    // 0>>2??
//     0, 1, 0, 2, -1, 1, -1, 2, 0, -1, 0, -2, -1, -1, -1, -2, 1, 0, 0, 3, 0, -3, // 1>>3???
//     -1, 0, -2, 0, -1, -1, -2, -1, 1, 0, 2, 0, 1, -1, 2, -1, 0, 1, -3, 0, 3, 0, // 2>>0???
//     0, 1, 0, 2, 1, 1, 1, 2, 0, -1, 0, -2, 1, -1, 1, -2, -1, 0, 0, 3, 0, -3     // 3>>1???
// };

// // 180???????????I?
// int srsIBlock180KickTable[11 * 2 * 4] = {
//     -1, 0, -2, 0, 1, 0, 2, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
//     0, 1, 0, 2, 0, -1, 0, -2, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
//     1, 0, 2, 0, -1, 0, -2, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
//     0, 1, 0, 2, 0, -1, 0, -2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
